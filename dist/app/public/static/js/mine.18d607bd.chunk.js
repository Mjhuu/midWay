(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[13],{294:function(e,t,a){"use strict";function n(e){var t=e.prototype.componentWillUnmount;e.prototype.componentWillUnmount=function(){t&&t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),this.unmount=!0};var a=e.prototype.setState;e.prototype.setState=function(){this.unmount||a.call.apply(a,[this].concat(Array.prototype.slice.call(arguments)))}}a.d(t,"a",(function(){return n}))},317:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return l})),a.d(t,"d",(function(){return s})),a.d(t,"g",(function(){return c})),a.d(t,"f",(function(){return i})),a.d(t,"e",(function(){return u}));a(24);function n(e){return/^[0-9A-Za-z][\.-_0-9A-Za-z]*@[0-9A-Za-z]+(\.[0-9A-Za-z]+)+$/.test(e)}function r(e){var t=e.replace(/^\s*|\s*$/g,""),a=t.length,n=0;return/[\d]/.test(t)&&n++,/[a-zA-Z]/.test(t)&&n++,/[^\w]/.test(t)&&n++,a>=6&&a<=16&&!/\s/.test(t)&&n>=2}function l(e){return/^([\u4E00-\uFA29]|[\uE7C7-\uE7F3]|[a-zA-Z0-9_])+$/.test(e)}function s(e){return/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])[0-9]{8}$/.test(e)}function c(e){e&&e.preventDefault?e.preventDefault():window.event.returnValue=!1}function i(e){return"string"===typeof e&&(e=e.replace(/<img(.*?)>/g,"[\u56fe\u7247]")),e}function u(e){var t=document.createElement("div");t.innerHTML=e;var a=t.innerText||t.textContent;return t=null,a}},409:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=[{label:"\u8d85\u7ea7\u7ba1\u7406\u5458",value:1},{label:"\u7ba1\u7406\u5458",value:2},{label:"\u666e\u901a",value:3}]},687:function(e,t,a){var n=a(688);"string"===typeof n&&(n=[[e.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};a(94)(n,r);n.locals&&(e.exports=n.locals)},688:function(e,t,a){(t=a(93)(!1)).push([e.i,"#mine_box {\n  width: 100%;\n  position: relative;\n}\n",""]),e.exports=t},985:function(e,t,a){"use strict";a.r(t);var n,r=a(126),l=a(9),s=a.n(l),c=a(24),i=a(26),u=a(38),o=a(39),m=a(40),p=a(41),d=a(0),f=a.n(d),h=a(988),g=a(284),b=a(971),v=a(356),E=a(328),w=a(53),I=a(550),y=a(980),x=a(978),N=a(996),j=a(979),k=(a(687),a(42)),C=a(18),O=a(54),S=a(125),_=a.n(S),z=a(409),A=a(317),Y=a(294),D=a(25),M=a(7),T=a.n(M),U=a(11),Z=h.a.TabPane,H=Object(k.b)((function(e){return{userInfo:e.userInfo}}),(function(e){return Object(C.b)({setUserInfo:O.a},e)}))(n=Object(Y.a)(n=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=t.call.apply(t,[this].concat(l))).state={baseInfo:{username:"",head_url:"",gender:1,telphone:"",mobile:"",email:"",department:"",job:"",role:1,join_time:"",createdAt:""},pwdInfo:{password:""},yzm:"",pwdCode:"",seconds:0,pwdSeconds:0,timer:null,pwdTimer:null,bindState:!1},e.updateUser=Object(i.a)(s.a.mark((function t(){var a,n,r,l,i,u,o,m,p,d,f;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.state.baseInfo,n=a.head_url,r=a.username,l=a.gender,i=a.telphone,u=a.mobile,Object(A.b)(r)){t.next=3;break}return t.abrupt("return",g.a.warning("\u7528\u6237\u540d\u683c\u5f0f\u9519\u8bef"));case 3:if(Object(A.d)(u)){t.next=5;break}return t.abrupt("return",g.a.warning("\u624b\u673a\u53f7\u683c\u5f0f\u9519\u8bef"));case 5:return t.next=7,Object(D.Y)({userId:U.a.getCache("userId"),username:r,mobile:u,telphone:i,head_url:n,gender:l});case 7:if(0!==(o=t.sent).status){t.next=15;break}return g.a.success("\u4fee\u6539\u6210\u529f"),m=o.result,p=m.userInfo,d=m.jobInfo,f=m.departmentInfo,t.next=13,e.props.setUserInfo(Object(c.a)({},p,{jobInfo:d,departmentInfo:f}));case 13:t.next=16;break;case 15:g.a.warning(o.msg);case 16:case"end":return t.stop()}}),t)}))),e.inputChange=function(t,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=t.target.value;if(1===n){var s=e.state.baseInfo;s[a]=l,e.setState({baseInfo:s})}else if(2===n)e.setState(Object(r.a)({},a,l));else{var c=e.state.pwdInfo;c[a]=l,e.setState({pwdInfo:c})}},e.selectImg=function(){var t=Object(i.a)(s.a.mark((function t(a,n){var r,l,c,i,u;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("image/jpeg"===(r=a.target.files[0]).type||"image/jpg"===r.type||"image/png"===r.type){t.next=3;break}return t.abrupt("return",g.a.warning("\u60a8\u4e0a\u4f20\u7684\u6587\u4ef6\uff1a"+r.name+"\u683c\u5f0f\u4e0d\u662fpng/jpg/jpeg\u683c\u5f0f\uff01\u8bf7\u91cd\u65b0\u9009\u62e9\uff01"));case 3:if(!(r.size>2097152)){t.next=5;break}return t.abrupt("return",g.a.warning("\u60a8\u4e0a\u4f20\u7684\u6587\u4ef6\uff1a"+r.name+"\u5927\u5c0f\u8d85\u8fc72M\uff01\u8bf7\u91cd\u65b0\u9009\u62e9\uff01"));case 5:return l=new FormData,c=U.a.getCache("userId"),l.append("file",r),l.append("type",n),l.append("userId",c),t.next=12,Object(D.Z)(l,c);case 12:0===(i=t.sent).status?(g.a.success(i.msg),(u=e.state.baseInfo)[n]=i.result.url,e.setState({baseInfo:u})):g.a.warning(i.data);case 14:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.sendYzm=Object(i.a)(s.a.mark((function t(){var a,n,r,l,c,u,o,m,p,d,f,h,b,v=arguments;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(2!==(v.length>0&&void 0!==v[0]?v[0]:1)){t.next=11;break}return a=e.state,n=a.pwdSeconds,r=a.pwdTimer,l=e.props.userInfo,c=l.email,t.next=7,Object(D.M)({email:c});case 7:0===(u=t.sent).status?(g.a.success(u.msg),r&&clearInterval(r),n=60,r=setInterval(Object(i.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==(n-=1)){t.next=6;break}return n=0,t.next=5,e.setState({pwdSeconds:n});case 5:return t.abrupt("return",clearInterval(r));case 6:return t.next=8,e.setState({pwdSeconds:n});case 8:case"end":return t.stop()}}),t)}))),1e3)):g.a.warning(u.msg),t.next=22;break;case 11:if(o=e.state,m=o.seconds,p=o.timer,d=o.baseInfo,f=e.props.userInfo,h=d.email,Object(A.a)(h)){t.next=16;break}return t.abrupt("return",g.a.warning("\u9a8c\u8bc1\u7801\u683c\u5f0f\u9519\u8bef"));case 16:if(f.email!==h){t.next=18;break}return t.abrupt("return",g.a.warning("\u8bf7\u8f93\u5165\u4e0e\u6362\u7ed1\u524d\u4e0d\u4e00\u6837\u7684\u90ae\u7bb1"));case 18:return t.next=20,Object(D.M)({email:h});case 20:0===(b=t.sent).status?(g.a.success(b.msg),p&&clearInterval(p),m=60,p=setInterval(Object(i.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==(m-=1)){t.next=6;break}return m=0,t.next=5,e.setState({seconds:m});case 5:return t.abrupt("return",clearInterval(p));case 6:return t.next=8,e.setState({seconds:m});case 8:case"end":return t.stop()}}),t)}))),1e3)):g.a.warning(b.msg);case 22:case"end":return t.stop()}}),t)}))),e.changeEmail=function(){e.setState({bindState:!0})},e.bindEmail=Object(i.a)(s.a.mark((function t(){var a,n,r,l,i,u,o,m;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.state,n=a.baseInfo,r=a.yzm,Object(A.a)(n.email)){t.next=3;break}return t.abrupt("return",g.a.warning("\u90ae\u7bb1\u683c\u5f0f\u9519\u8bef"));case 3:if(6===r.length){t.next=5;break}return t.abrupt("return",g.a.warning("\u8bf7\u8f93\u51656\u4f4d\u9a8c\u8bc1\u7801"));case 5:return t.next=7,Object(D.P)({email:n.email,verifycode:r,userId:U.a.getCache("userId")});case 7:if(0!==(l=t.sent).status){t.next=16;break}return g.a.success("\u90ae\u7bb1\u6362\u7ed1\u6210\u529f"),i=l.result,u=i.userInfo,o=i.jobInfo,m=i.departmentInfo,t.next=13,e.props.setUserInfo(Object(c.a)({},u,{jobInfo:o,departmentInfo:m}));case 13:e.setState({bindState:!1}),t.next=17;break;case 16:g.a.warning(l.msg);case 17:case"end":return t.stop()}}),t)}))),e}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.baseInfo,n=t.yzm,r=t.pwdInfo,l=t.seconds,s=t.bindState,c=t.pwdCode,i=t.pwdSeconds,u=this.props.userInfo;return f.a.createElement("div",{id:"mine_box"},f.a.createElement(h.a,null,f.a.createElement(Z,{tab:f.a.createElement("span",null,f.a.createElement(y.a,null),"\u57fa\u672c\u8d44\u6599"),key:"baseInfo"},f.a.createElement("ul",{className:"ul",style:{marginTop:"1rem"}},f.a.createElement("li",null,f.a.createElement("div",{className:"left tip"},"\u5934\u50cf\uff1a"),f.a.createElement("div",{className:"right"},f.a.createElement("div",{className:"headImg"},f.a.createElement("div",{className:"update-headImg"},f.a.createElement(x.a,{style:{fontSize:"2.3rem"}}),f.a.createElement("span",{style:{marginTop:".3rem"}},"\u4fee\u6539\u5934\u50cf"),f.a.createElement("input",{onChange:function(t){return e.selectImg(t,"head_url")},type:"file",title:"\u8bf7\u9009\u62e9\u5934\u50cf"})),f.a.createElement("img",{src:a.head_url?D.a+a.head_url:_.a,alt:"\u5934\u50cf"})))),f.a.createElement("li",null,f.a.createElement("div",{className:"left tip"},"\u59d3\u540d\uff1a"),f.a.createElement("div",{className:"right"},f.a.createElement(b.a,{style:{width:"30rem"},onChange:function(t){return e.inputChange(t,"username")},value:a.username,type:"text",placeholder:"\u8bf7\u8f93\u5165\u59d3\u540d"}))),f.a.createElement("li",null,f.a.createElement("div",{className:"left"},"\u6027\u522b\uff1a"),f.a.createElement("div",{className:"right"},f.a.createElement(v.default.Group,{value:a.gender,onChange:function(t){return e.inputChange(t,"gender")},buttonStyle:"solid"},f.a.createElement(v.default.Button,{value:1},"\u7537"),f.a.createElement(v.default.Button,{value:0},"\u5973")))),f.a.createElement("li",null,f.a.createElement("div",{className:"left"},"\u529e\u516c\u5ba4\u7535\u8bdd\uff1a"),f.a.createElement("div",{className:"right"},f.a.createElement(b.a,{style:{width:"30rem"},onChange:function(t){return e.inputChange(t,"telphone")},value:a.telphone,type:"text",placeholder:"\u8bf7\u8f93\u5165\u529e\u516c\u5ba4\u7535\u8bdd"}))),f.a.createElement("li",null,f.a.createElement("div",{className:"left tip"},"\u624b\u673a\u53f7\uff1a"),f.a.createElement("div",{className:"right"},f.a.createElement(b.a,{style:{width:"30rem"},onChange:function(t){return e.inputChange(t,"mobile")},value:a.mobile,type:"text",placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7"}))),f.a.createElement("li",null,f.a.createElement("div",{className:"left tip"},"\u90ae\u7bb1\uff1a"),f.a.createElement("div",{className:"right"},a.email||"---")),f.a.createElement("li",null,f.a.createElement("div",{className:"left tip"},"\u90e8\u95e8\uff1a"),f.a.createElement("div",{className:"right"},a.department||"---")),f.a.createElement("li",null,f.a.createElement("div",{className:"left tip"},"\u804c\u4f4d\uff1a"),f.a.createElement("div",{className:"right"},a.job||"---")),f.a.createElement("li",null,f.a.createElement("div",{className:"left"},"\u89d2\u8272\uff1a"),f.a.createElement("div",{className:"right"},z.a.filter((function(e){return e.value===Number(a.role)})).length>0?f.a.createElement(E.a,{color:"#108ee9"},z.a.filter((function(e){return e.value===Number(a.role)}))[0].label):"---")),f.a.createElement("li",null,f.a.createElement("div",{className:"left tip"},"\u5165\u804c\u65f6\u95f4\uff1a"),f.a.createElement("div",{className:"right"},a.join_time||"---")),f.a.createElement("li",null,f.a.createElement("div",{className:"left"},"\u521b\u5efa\u65f6\u95f4\uff1a"),f.a.createElement("div",{className:"right"},a.createdAt||"---")),f.a.createElement("li",null,f.a.createElement("div",{className:"left"}),f.a.createElement("div",{className:"right"},f.a.createElement(w.a,{onClick:function(){return e.updateUser()},type:"primary"},"\u4fdd\u5b58\u4fe1\u606f"))))),f.a.createElement(Z,{tab:f.a.createElement("span",null,f.a.createElement(N.a,null),"\u90ae\u7bb1\u7ba1\u7406"),key:"email"},f.a.createElement(I.a,{message:"\u90ae\u7bb1\u7528\u4e8e\u63a5\u6536\u5de5\u4f5c\u63d0\u9192\uff0c\u52a1\u5fc5\u7ed1\u5b9a\u5e38\u7528\u90ae\u7bb1\u3002",type:"info",showIcon:!0}),f.a.createElement("ul",{className:"ul",style:{marginTop:"2rem"}},f.a.createElement("li",null,f.a.createElement("div",{className:"left"},"\u90ae\u7bb1\uff1a"),f.a.createElement("div",{className:"right"},f.a.createElement(b.a,{style:{width:"30rem"},className:"input",placeholder:"\u7ed1\u5b9a\u90ae\u7bb1",disabled:!s,value:a.email,onChange:function(t){return e.inputChange(t,"email")}}),!s&&f.a.createElement("span",{style:{color:"#096dd9",fontSize:"1.3rem",marginLeft:"1rem",cursor:"pointer"},onClick:function(){return e.changeEmail()}},"\u6362\u7ed1"))),s&&f.a.createElement("li",null,f.a.createElement("div",{className:"left"},"\u9a8c\u8bc1\u7801\uff1a"),f.a.createElement("div",{className:"right"},f.a.createElement(b.a,{className:"input",placeholder:"\u9a8c\u8bc1\u7801",value:n,style:{width:"15rem",marginRight:"1rem"},onChange:function(t){return e.inputChange(t,"yzm",2)}}),0===l?f.a.createElement(w.a,{onClick:function(){return e.sendYzm()}},"\u83b7\u53d6\u9a8c\u8bc1\u7801"):f.a.createElement(w.a,{disabled:!0},l,"s\u540e\u91cd\u65b0\u83b7\u53d6"))),s&&f.a.createElement("li",null,f.a.createElement("div",{className:"left"}),f.a.createElement("div",{className:"right"},f.a.createElement(w.a,{onClick:function(){return e.bindEmail()},type:"primary"},"\u7ed1\u5b9a\u90ae\u7bb1"))))),f.a.createElement(Z,{tab:f.a.createElement("span",null,f.a.createElement(j.a,null),"\u4fee\u6539\u5bc6\u7801"),key:"password"},f.a.createElement(I.a,{message:"\u5c06\u5411\u60a8\u7684\u5b89\u5168\u90ae\u7bb1 ".concat(u.email||"xxx"," \u53d1\u9001\u9a8c\u8bc1\u7801\u3002"),type:"info",showIcon:!0}),f.a.createElement("ul",{className:"ul",style:{marginTop:"2rem"}},f.a.createElement("li",null,f.a.createElement("div",{className:"left tip"},"\u9a8c\u8bc1\u7801\uff1a"),f.a.createElement("div",{className:"right"},f.a.createElement(b.a,{className:"input",placeholder:"\u9a8c\u8bc1\u7801",value:c,style:{width:"15rem",marginRight:"1rem"},onChange:function(t){return e.inputChange(t,"pwdCode",2)}}),0===i?f.a.createElement(w.a,{onClick:function(){return e.sendYzm(2)}},"\u83b7\u53d6\u9a8c\u8bc1\u7801"):f.a.createElement(w.a,{disabled:!0},i,"s\u540e\u91cd\u65b0\u83b7\u53d6"))),f.a.createElement("li",null,f.a.createElement("div",{className:"left tip"},"\u65b0\u5bc6\u7801\uff1a"),f.a.createElement("div",{className:"right"},f.a.createElement(b.a,{style:{width:"26rem"},onChange:function(t){return e.inputChange(t,"password",3)},value:r.password,placeholder:"\u8bf7\u8f93\u5165\u65b0\u5bc6\u7801"}))),f.a.createElement("li",null,f.a.createElement("div",{className:"left"}),f.a.createElement("div",{className:"right"},f.a.createElement(w.a,{onClick:function(t){return e.updatePwd(t,2)},type:"primary"},"\u4fee\u6539\u5bc6\u7801")))))))}},{key:"componentDidUpdate",value:function(e,t,a){JSON.stringify(e.userInfo)!==JSON.stringify(this.props.userInfo)&&this.initInfo()}},{key:"componentDidMount",value:function(){this.initInfo()}},{key:"initInfo",value:function(){var e=this.props.userInfo;if(e.user_id){var t=e.username,a=e.head_url,n=e.gender,r=e.telphone,l=e.mobile,s=e.email,c=(e.job,e.role),i=e.join_time,u=e.createdAt,o=e.jobInfo,m={username:t,head_url:a,gender:n,telphone:r,mobile:l,email:s,department:e.departmentInfo.department_name,job:o?o.job_name:"---",role:c,join_time:T()(i||new Date).format("YYYY/MM/DD HH:mm:ss"),createdAt:T()(u).format("YYYY/MM/DD HH:mm:ss")};this.setState({baseInfo:m})}}},{key:"updatePwd",value:function(){var e=Object(i.a)(s.a.mark((function e(){var t,a,n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state,a=t.pwdCode,n=t.pwdInfo,6===a.length){e.next=3;break}return e.abrupt("return",g.a.warning("\u8bf7\u8f93\u51656\u4f4d\u9a8c\u8bc1\u7801"));case 3:if(Object(A.c)(n.password)){e.next=5;break}return e.abrupt("return",g.a.warning("\u5bc6\u7801\u5fc5\u987b\u75316-16\u4f4d\u7531\u6570\u5b57\u5b57\u6bcd\u7b26\u53f7\u81f3\u5c11\u4e24\u79cd\u7ec4\u6210"));case 5:return e.next=7,Object(D.V)({userId:U.a.getCache("userId"),password:n.password,verifycode:a});case 7:0===(r=e.sent).status?(g.a.success("\u5bc6\u7801\u4fee\u6539\u6210\u529f"),U.a.delCache("userId"),this.props.setUserInfo({}),this.props.history.replace("/login")):g.a.warning(r.msg);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),a}(d.Component))||n)||n;t.default=H}}]);